using Microsoft.AspNetCore.Hosting;
using Microsoft.Extensions.DependencyInjection;
using Moq;
using PPTail.Entities;
using PPTail.Interfaces;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using TestHelperExtensions;

namespace PPTail.Web.PostLocator.Test
{
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverage]
    public static class Extensions
    {
        const String _createDasBlogSyndicationCompatibilityFileSettingName = "createDasBlogSyndicationCompatibilityFile";
        const String _createDasBlogPostsCompatibilityFileSettingName = "createDasBlogPostsCompatibilityFile";

        public static IServiceCollection Create(this IServiceCollection ignore)
        {
            var container = new ServiceCollection();

            String xml = "<posts><post id=\"0271dd63-b142-4a67-877b-42629f64a477\" url=\"Posts\\Emitting-XML.html\"/><post id=\"02bf7ca7-b667-45fe-86b8-5c2164aa1df7\" url=\"Posts\\Using-the-Entity-Framework-with-databases-that-have-foreign-key-relationships-that-do-not-link-to-the-primary-key-of-the-child-element.html\"/><post id=\"04f6969d-95ba-4415-8ebe-2d40be523333\" url=\"Posts\\VBNET-20-Language-Changes-Give-You-More.html\"/><post id=\"06189847-eb2f-4498-87e0-99c0efe69233\" url=\"Posts\\Tentative-AZGiveCamp-Organizers-Meeting-Agenda.html\"/><post id=\"06bd7503-d4f6-46fb-9a0b-5ab002531568\" url=\"Posts\\Introduction-to-AgileExtreme-Programming.html\"/><post id=\"0836bb99-7766-4450-9ded-fe981f771e67\" url=\"Posts\\Office-Lense28093Magic-in-a-Free-App.html\"/><post id=\"09a68c70-e4bc-494b-852b-e067b55c00e1\" url=\"Posts\\Simplify-Your-API.html\"/><post id=\"09a8e9d0-5295-4aa0-8306-5b4a2980ae30\" url=\"Posts\\The-Next-Old-New-way-of-Thinking-About-App-Interfaces.html\"/><post id=\"0b6ef5a0-8796-4ade-8957-af792b706a2a\" url=\"Posts\\Exception-Handling-Block.html\"/><post id=\"0d6e40b6-e082-4a7d-a952-8850ef1e33d8\" url=\"Posts\\Security-Problems.html\"/><post id=\"0e48d7c1-74ef-45f1-8502-ec3577714ede\" url=\"Posts\\Will-Augmented-Reality-Finally-Make-My-Lifes-Dream-Come-True.html\"/><post id=\"12361edd-560a-4532-bec9-53b11dc3767e\" url=\"Posts\\Sample-Using-Statement-in-VBNET-2005.html\"/><post id=\"127542b6-45e7-4ca9-a338-5ebce5385184\" url=\"Posts\\Order-Matters-in-the-Rhino-Mocks-Fluent-Interface.html\"/><post id=\"16ee9efb-bcb7-4972-8c4c-1790656bed7d\" url=\"Posts\\Desert-Code-Camp-IV-Another-Great-Day.html\"/><post id=\"1ad203b0-f604-43c0-8293-aad482376f98\" url=\"Posts\\Windows-8-Store-Development-for-Enterprise-Devs.html\"/><post id=\"1b5f1ddb-ad42-446e-b484-783712195c61\" url=\"Posts\\Use-One-Email-Alias-per-Account.html\"/><post id=\"20380740-06e6-4b0a-82ea-2d7ae4f368bc\" url=\"Posts\\Programmers-Take-Responsibility-for-Your-Programe28099s-Output.html\"/><post id=\"267c3074-4604-4ce3-a3ae-8edd2ffb44fb\" url=\"Posts\\Top-10-Developer-Skills.html\"/><post id=\"29651b20-4695-4d5e-82c7-5ac564f6a5b7\" url=\"Posts\\AZGiveCamp-III-is-Oct-21st-23rd.html\"/><post id=\"29ce92c0-ad0f-43b4-8286-228bf43b6d77\" url=\"Posts\\Ive-Accepted-a-Position-at-US-Airways.html\"/><post id=\"2eb911d4-b484-48f6-9986-5534a1f5581f\" url=\"Posts\\Encapsulation-and-Generic-Lists.html\"/><post id=\"2f823b30-355a-49e1-8ecf-121cff1b3547\" url=\"Posts\\Afternoon-Day-2.html\"/><post id=\"2f979553-02ba-46ae-9aff-027ab9f8916e\" url=\"Posts\\Stay-Tuned.html\"/><post id=\"31ea041b-f62a-4f0a-a63e-453c79435c03\" url=\"Posts\\PDC-2008-Day-1.html\"/><post id=\"34335f38-c0b5-4ad4-b7a7-e3d3ec0dc382\" url=\"Posts\\Profile-Provider-Exception.html\"/><post id=\"35e0b224-6e56-41d9-9ab1-69e00ea598de\" url=\"Posts\\PDC-2008.html\"/><post id=\"36949ad5-1066-4686-81b2-ce7e5c4d8bcc\" url=\"Posts\\Code-Sample-for-My-TDD-Kickstart-Sessions.html\"/><post id=\"36e532a9-b98b-4400-a099-f2204c340a50\" url=\"Posts\\User-Experience-Done-Better.html\"/><post id=\"39a71c38-6692-49c9-94fe-a70aa9035078\" url=\"Posts\\PDC-2008-Day-2.html\"/><post id=\"39f292b1-d7c4-4f4a-9e65-75ab29adbb8f\" url=\"Posts\\Day-2-Early-PM.html\"/><post id=\"3aafd970-63fc-4772-a50c-e4500d96fbfc\" url=\"Posts\\Dictionary-of-PDC-e2809803-Terms.html\"/><post id=\"3cc08607-5998-4b6d-a7e0-0876d4cc4f7d\" url=\"Posts\\Dev-Ignite-2-Slide-Deck-Submitted.html\"/><post id=\"3f26d6de-511b-4b50-992a-3fdac2eb753f\" url=\"Posts\\Best-of-PDC-Phoenix-in-Tweets.html\"/><post id=\"40678866-7f86-441f-a1e4-3bb7215c8d5d\" url=\"Posts\\The-Missing-e2809cCreate-Unit-Teste2809d-feature-in-Visual-Studio-2012.html\"/><post id=\"4257293b-e5c1-4308-acea-340a1f31b094\" url=\"Posts\\A-Software-Developers-View-of-Dynamic-Programming.html\"/><post id=\"496f2d62-3c89-46fc-b04d-5cf5f81fa82d\" url=\"Posts\\Remove-Any-Code-Your-Users-Dont-Care-About.html\"/><post id=\"4b9ad089-0e5f-4ce4-81f2-0f1d4a5dfaed\" url=\"Posts\\AZGiveCamp-III-Organization-Starts-33.html\"/><post id=\"4bc96af9-3789-4658-a678-f01cba480b13\" url=\"Posts\\Presentation-Proposal-Developer-Ignite-Phoenix.html\"/><post id=\"52bfe53a-9e7b-4431-92b7-0d50ae7197ec\" url=\"Posts\\Desert-Code-Camp-Presentation.html\"/><post id=\"556cde80-bc1a-412f-ab63-9b505ec49970\" url=\"Posts\\PDC-Keynote-Live-Stream.html\"/><post id=\"567d54a3-06c2-4939-9655-6d045be217fb\" url=\"Posts\\Removing-Assemblies-from-the-GAC.html\"/><post id=\"59574c73-c66f-498e-885b-224f52d419b5\" url=\"Posts\\Developer-Ignite-Presentation-Slide-Deck.html\"/><post id=\"68e81aad-a521-442d-9846-9f4e894a9d60\" url=\"Posts\\Final-Day.html\"/><post id=\"69c65f4d-352e-4e1d-92bd-79d5b8cae4b3\" url=\"Posts\\NET-Open-Source-Projects.html\"/><post id=\"69eed32b-9eeb-43df-908d-29b3eae4a395\" url=\"Posts\\Introducing-TestHelperExtensions.html\"/><post id=\"6b32cba3-22ad-4c34-933a-64324a8eb2b7\" url=\"Posts\\Day-1.html\"/><post id=\"6ba711ad-9052-4ab0-bf94-a66b962d8725\" url=\"Posts\\Developer-Ignite-in-Chandler.html\"/><post id=\"6d2efe42-e15b-45ae-bbca-f20e1beec3cf\" url=\"Posts\\Oracle-String-SQL-Query-using-a-DateTime-from-C.html\"/><post id=\"7033a3af-acf1-49a5-877a-a66d22f175c8\" url=\"Posts\\XSL-vs-Regular-Expressions.html\"/><post id=\"77c8094b-6a05-483c-8381-787e218075bb\" url=\"Posts\\Creating-Custom-Controls-for-ASPNET-20.html\"/><post id=\"79730947-05cd-4621-af5d-954b114d92ff\" url=\"Posts\\Day-2-PM.html\"/><post id=\"7babb559-7848-4372-bada-55463a717865\" url=\"Posts\\Enterprise-Library-Overview.html\"/><post id=\"7ca6c1bf-2566-434d-8382-33680f1b0d70\" url=\"Posts\\Unit-Testing-the-Data-Tier.html\"/><post id=\"7de3f401-e11b-4170-b1fe-d3b3f71c303d\" url=\"Posts\\TDD-Helps-Validate-Your-Tests.html\"/><post id=\"84fe235c-8b83-438b-aa0f-6dcede58cce3\" url=\"Posts\\I-have-arrived-at-the-PDC.html\"/><post id=\"85f50739-19ea-49c6-ad0e-86c5c4ab0c43\" url=\"Posts\\Speaking-Engagements-for-October-2015.html\"/><post id=\"87ce8579-fb47-471a-89d0-1603011eca99\" url=\"Posts\\Dynamic-Optimization-Presentation.html\"/><post id=\"88aceb3e-d489-4236-87d2-68d39d634a80\" url=\"Posts\\T-SQL-2005.html\"/><post id=\"88da0d75-ea12-4eb5-ac5c-0b197dd8bc48\" url=\"Posts\\No-More-Collection-Objects.html\"/><post id=\"8d5a0399-f8d1-4631-bd28-1cdddb0a64ac\" url=\"Posts\\Demo-Code-for-EF4Ent-Sessions.html\"/><post id=\"8e142988-0bff-4d11-b40b-823985a5f6e1\" url=\"Posts\\Solving-DataSet-Constraint-Problems.html\"/><post id=\"97da9a1a-2df5-4cc6-8712-a4537a47c341\" url=\"Posts\\Looking-for-Evening-Events-at-Mix11.html\"/><post id=\"9b50d169-d967-4ee1-ba25-e97713bed19b\" url=\"Posts\\Conflict-of-Interest-YAGNI-vs-Standardization.html\"/><post id=\"9b51fb05-53a6-44e0-bddb-fddfa1b542dc\" url=\"Posts\\Two-Features-you-Need-in-Your-Service-SLAs.html\"/><post id=\"9cbe95f7-59e3-4fe7-9c56-687f7daaa1da\" url=\"Posts\\No-summary-of-day-3-yet.html\"/><post id=\"9cdcc051-3acd-4300-9ad8-86786ec7e647\" url=\"Posts\\OneNote-Notebooks-remain-e2809cNot-Connectede2809d.html\"/><post id=\"9e81f613-52ca-4108-acb4-f0f2ad3d36dc\" url=\"Posts\\nUnit-vs-VSTS.html\"/><post id=\"9f79e2fa-5718-4d0d-ba4a-1ebdefd556f8\" url=\"Posts\\SQL-ERD-for-Membership-and-Other-ASPNET-20-Services.html\"/><post id=\"a04cf900-bb3f-4149-bbea-146cfcd94167\" url=\"Posts\\Why-I-Am-Attending-the-Pluralsight-e2809cAlgorithms-and-Data-Structurese2809d-Webcast.html\"/><post id=\"aaa35320-c03d-41ef-95bc-8b79614344fb\" url=\"Posts\\NET-TDD-Kickstart.html\"/><post id=\"ab6940e3-5422-4be6-8722-028636eeac46\" url=\"Posts\\NET-20-Concerns.html\"/><post id=\"aec1e03c-9f19-4d72-aae4-a3ebb9c1dfea\" url=\"Posts\\New-OSS-Project.html\"/><post id=\"b103a065-2760-4f21-ab0e-c30a7fc01950\" url=\"Posts\\PDC-Day-1.html\"/><post id=\"b1c44e28-3037-44b4-9f75-7223944d1cb0\" url=\"Posts\\Owning-Code-is-Evil.html\"/><post id=\"b34cda30-913e-40d1-b950-a8b650aaf361\" url=\"Posts\\Entity-Framework-Inheritance.html\"/><post id=\"b355a0d2-5465-4d99-ac67-adeae7f2d7e2\" url=\"Posts\\Day-2-Am.html\"/><post id=\"b3dd8698-1f6b-412f-ab52-a48422b79926\" url=\"Posts\\e2809cOne-Reason-to-Changee2809d-Means-the-Code.html\"/><post id=\"b4d0b40f-8268-4cdd-a102-fec4317f463c\" url=\"Posts\\Two-Things-I-Learned-on-Pex4Funcom-Today.html\"/><post id=\"b999239d-2aa8-49ed-a189-c9753dd52c5a\" url=\"Posts\\AZGiveCamp-II-Announced!.html\"/><post id=\"bbcd1ce3-22d3-47b2-90b0-02fef43a1984\" url=\"Posts\\Multiple-Inheritance-Its-Time-Should-Come-Again-Soon.html\"/><post id=\"bce4ff0e-ab0c-4d75-a04d-4b8c207cceb5\" url=\"Posts\\Wiffle-Ball-for-Charity.html\"/><post id=\"bd40aaeb-c0af-43e4-badb-6b95327f8e9e\" url=\"Posts\\Using-Target-Specific-Code-in-a-Portable-Library.html\"/><post id=\"c1475e88-70c3-4c8f-b122-633cb78e77f0\" url=\"Posts\\Microsoft-Developers-and-HTML5.html\"/><post id=\"c34168ee-706f-4c7d-9665-ffd986b6f1b6\" url=\"Posts\\Regain-Access-to-the-CreateUnitTests-Command-in-VS2012.html\"/><post id=\"c451dcdf-72fa-4d5d-b1b0-6f04ba1f2dc8\" url=\"Posts\\Development-Posters.html\"/><post id=\"c541f92a-a77e-4556-a13d-0b8cb70a9518\" url=\"Posts\\Use-SystemDateTimeOffset-To-Better-Handle-Time-Zones.html\"/><post id=\"c71cbe7d-a235-4aa8-85da-4cd67d761c29\" url=\"Posts\\Server-Crash.html\"/><post id=\"c8aadf7b-b60b-4b46-9efd-3f28f51b3c89\" url=\"Posts\\Programming-Jargon-Dictionary.html\"/><post id=\"ca95fc20-b4f5-4e5b-90f0-59548c5f5709\" url=\"Posts\\SOAe28093Beyond-the-Buzzwords.html\"/><post id=\"cc363ae8-3e14-4947-adfc-7bcd098eee4a\" url=\"Posts\\Using-Constraints-in-Rhino-Mocks.html\"/><post id=\"cd8c3b37-e298-4768-88b8-c2e2de937adf\" url=\"Posts\\10-Common-ASPNET-Pitfalls.html\"/><post id=\"ceb59f2f-55d7-447b-8470-a19d93fb29e7\" url=\"Posts\\Are-you-Ready-for-the-Next-Episode.html\"/><post id=\"d0785b7f-ff4d-4ffd-9347-151cfef6bce0\" url=\"Posts\\Web-Parts-in-ASPNET-20.html\"/><post id=\"d34e85e8-1ef9-4605-8e74-5bb897823816\" url=\"Posts\\Day-2-AM.html\"/><post id=\"d464359a-64f2-40ee-9642-b507447180d0\" url=\"Posts\\Upcoming-Presentations.html\"/><post id=\"d615e6b9-cd71-47f7-9c5b-42e834bb1201\" url=\"Posts\\Generics-Concerns.html\"/><post id=\"d9257fea-1c85-4820-9080-4f711ba8b08e\" url=\"Posts\\Continuous-Improvement-as-a-Developer.html\"/><post id=\"dade0093-4e08-4576-9ea3-b9fc326d6a81\" url=\"Posts\\Test-Driven-Bug-Fixes.html\"/><post id=\"dc2a5cb7-eda4-45d0-9d22-51d5b843a3aa\" url=\"Posts\\My-Comments-to-the-FCC-on-Net-Neutrality.html\"/><post id=\"dd43877e-c55c-4db6-b859-c148aaa2d8f5\" url=\"Posts\\Arrival.html\"/><post id=\"dde02ea3-ba8e-4066-8dc6-9cb9dbadc450\" url=\"Posts\\Code-Analysis-Rules.html\"/><post id=\"dfc47978-fa8c-4f3f-a75d-f2c917cb12d4\" url=\"Posts\\South-Florida-Code-Camp-2011.html\"/><post id=\"e18ba99d-acc2-4eb8-b49c-6cce3abcb550\" url=\"Posts\\Summary-Desert-Code-Camp-2006.html\"/><post id=\"e203ddde-e61f-4d1d-bf55-9749f9e8c3c6\" url=\"Posts\\Unit-Test-Normalization.html\"/><post id=\"e20b651b-c0d5-40c0-a94c-29bccce46b8a\" url=\"Posts\\Annual-Scott-Guthrie-Day-in-Phoenix.html\"/><post id=\"e3217f4e-426d-4a6e-99f0-9f00b92c7f00\" url=\"Posts\\Not-Following-API-Guidelines-Has-Impact.html\"/><post id=\"eb66140c-73cf-4690-9b36-d42c924851a6\" url=\"Posts\\Visual-Studio-Unit-Test-Generator.html\"/><post id=\"ebfc5816-e855-47dd-898b-8163932d85ef\" url=\"Posts\\Sample-SQL-2000-XML-Query-Courtesy-of-AE.html\"/><post id=\"ece1a3f3-8f27-40fe-9a89-a13892032e23\" url=\"Posts\\Testing-Properties-with-Inconsistent-Accessibility.html\"/><post id=\"ef5deb5d-71c5-4081-b4ba-433fd935dc71\" url=\"Posts\\Decorating-Partial-Class-Members-in-C.html\"/><post id=\"f0cbf275-d47c-49f4-bdb6-bace6f73d6d7\" url=\"Posts\\Loosely-Coupled-Apps.html\"/><post id=\"f6b7e83b-8a06-4502-9f5c-234899710422\" url=\"Posts\\Tech-Bubble-Version-20.html\"/><post id=\"fa64c95d-3b3d-4192-8c35-86d1a64d4cda\" url=\"Posts\\Holding-the-Web-on-Your-Shoulders-With-Atlas.html\"/><post id=\"a3ea73ac-e2cd-4448-be56-b19744cd7c57\" url=\"Posts\\Optimization-for-Developers.html\"/><post id=\"8f4f1c21-d85d-4cb2-9454-56cb80aadaf7\" url=\"Posts\\AZGiveCamp-is-Breaking-the-Mold.html\"/><post id=\"72788e69-f45b-4a22-a119-ff117f5c9bf3\" url=\"Posts\\A-Busy-October-and-November.html\"/><post id=\"68269657-e0c9-430d-acd4-9b4cc211fcc7\" url=\"Posts\\Code-Coverage-Teaches-and-Protects.html\"/></posts>";
            var file = new Mock<IFile>();
            file.Setup(f => f.ReadAllText(It.IsAny<string>()))
                .Returns(xml);
            container.AddSingleton<IFile>(file.Object);

            container.AddSingleton<IHostingEnvironment>(Mock.Of<IHostingEnvironment>());

            return container;
        }

        public static IServiceCollection RemoveDependency<T>(this IServiceCollection container) where T : class
        {
            var item = container.Where(sd => sd.ServiceType == typeof(T)).Single();
            container.Remove(item);
            return container;
        }

        public static IServiceCollection ReplaceDependency<T>(this IServiceCollection container, T serviceInstance) where T : class
        {
            container.RemoveDependency<T>();
            container.AddSingleton<T>(serviceInstance);
            return container;
        }

    }
}
